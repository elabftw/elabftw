/*! elabftw 1.6.0 https://www.elabftw.net */

$(document).ready(function(){document.title=$("#entityInfos").data("title");var type=$("#entityInfos").data("type"),id=$("#entityInfos").data("id"),confirmText=$("#entityInfos").data("confirm");$(document).on("click","#lock",function(){$.post("app/controllers/EntityController.php",{lock:!0,type:type,id:id}).done(function(data){var json=JSON.parse(data);json.res?(notif(json.msg,"ok"),current=$("#lock").attr("src"),"app/img/lock-gray.png"===current?$("#lock").attr("src","app/img/unlock.png"):$("#lock").attr("src","app/img/lock-gray.png")):notif(json.msg,"ko")})}),$(document).on("click",".click2Edit",function(){var page=$(this).data("page");document.location=page+"?mode=edit&id="+id});var Comments={controller:"app/controllers/CommentsController.php",create:function(){if(document.getElementById("commentsCreateButton").disabled=!0,comment=$("#commentsCreateArea").val(),comment.length<2)return notif("Comment too short!"),document.getElementById("commentsCreateButton").disabled=!1,!1;$.post(this.controller,{commentsCreate:!0,comment:comment,id:id}).done(function(data){var json=JSON.parse(data);json.res?(notif(json.msg,"ok"),$("#expcomment_container").load("experiments.php?mode=view&id="+id+" #expcomment")):notif(json.msg,"ko")})},destroy:function(comment){if(!confirm(confirmText))return!1;$.post(this.controller,{destroy:!0,id:comment}).done(function(data){var json=JSON.parse(data);json.res?(notif(json.msg,"ok"),$("#expcomment_container").load("experiments.php?mode=view&id="+id+" #expcomment")):notif(json.msg,"ko")})}};$("#commentsCreateButtonDiv").hide(),$(document).on("focus","#commentsCreateArea",function(){$("#commentsCreateButtonDiv").show()}),$(document).on("click","#commentsCreateButton",function(){Comments.create($(this).data("expid"))}),$(document).on("mouseover",".editable",function(){$("div#expcomment p.editable").editable(Comments.controller,{name:"commentsUpdate",tooltip:"Click to edit",indicator:$(this).data("indicator"),submit:$(this).data("submit"),cancel:$(this).data("cancel"),style:"display:inline",callback:function(){$("#expcomment_container").load("experiments.php?mode=view&id="+id+" #expcomment")}})}),$(document).on("click",".commentsDestroy",function(){Comments.destroy($(this).data("id"))}),$(document).on("click","#confirmTimestamp",function(){$("#confirmTimestampDiv").dialog({resizable:!1,height:"auto",width:400,modal:!0,buttons:{"Timestamp it":function(){$("#confirmTimestampDiv").text($(this).data("wait")),$.post("app/controllers/ExperimentsController.php",{timestamp:!0,id:id}).done(function(data){var json=JSON.parse(data);json.res?window.location.replace("experiments.php?mode=view&id="+id):notif(json.msg,"ko")})},Cancel:function(){$(this).dialog("close")}}})}),$("#confirmTimestampDiv").hide(),key($("#shortcuts").data("create"),function(){location.href=$("#entityInfos").data("controller")+"?create=true"}),key($("#shortcuts").data("edit"),function(){location.href=$("#entityInfos").data("page")+"?mode=edit&id="+$("#entityInfos").data("id")})}),function(window,document,$,undefined){"use strict";function _run(e){var target=e.currentTarget,opts=e.data?e.data.options:{},items=e.data?e.data.items:[],value="",index=0;e.preventDefault(),e.stopPropagation(),$(target).attr("data-fancybox")&&(value=$(target).data("fancybox")),value?index=(items=items.length?items.filter('[data-fancybox="'+value+'"]'):$("[data-fancybox="+value+"]")).index(target):items=[target],$.fancybox.open(items,opts,index)}if($){var defaults={speed:330,loop:!0,opacity:"auto",margin:[44,0],gutter:30,infobar:!0,buttons:!0,slideShow:!0,fullScreen:!0,thumbs:!0,closeBtn:!0,smallBtn:"auto",image:{preload:"auto",protect:!1},ajax:{settings:{data:{fancybox:!0}}},iframe:{tpl:'<iframe id="fancybox-frame{rnd}" name="fancybox-frame{rnd}" class="fancybox-iframe" frameborder="0" vspace="0" hspace="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen allowtransparency="true" src=""></iframe>',preload:!0,scrolling:"no",css:{}},baseClass:"",slideClass:"",baseTpl:'<div class="fancybox-container" role="dialog" tabindex="-1"><div class="fancybox-bg"></div><div class="fancybox-controls"><div class="fancybox-infobar"><button data-fancybox-previous class="fancybox-button fancybox-button--left" title="Previous"></button><div class="fancybox-infobar__body"><span class="js-fancybox-index"></span>&nbsp;/&nbsp;<span class="js-fancybox-count"></span></div><button data-fancybox-next class="fancybox-button fancybox-button--right" title="Next"></button></div><div class="fancybox-buttons"><button data-fancybox-close class="fancybox-button fancybox-button--close" title="Close (Esc)"></button></div></div><div class="fancybox-slider-wrap"><div class="fancybox-slider"></div></div><div class="fancybox-caption-wrap"><div class="fancybox-caption"></div></div></div>',spinnerTpl:'<div class="fancybox-loading"></div>',errorTpl:'<div class="fancybox-error"><p>The requested content cannot be loaded. <br /> Please try again later.<p></div>',closeTpl:'<button data-fancybox-close class="fancybox-close-small"></button>',parentEl:"body",touch:!0,keyboard:!0,focus:!0,closeClickOutside:!0,beforeLoad:$.noop,afterLoad:$.noop,beforeMove:$.noop,afterMove:$.noop,onComplete:$.noop,onInit:$.noop,beforeClose:$.noop,afterClose:$.noop,onActivate:$.noop,onDeactivate:$.noop},$W=$(window),$D=$(document),called=0,isQuery=function(obj){return obj&&obj.hasOwnProperty&&obj instanceof $},requestAFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(callback){window.setTimeout(callback,1e3/60)}}(),isElementInViewport=function(el){var rect;return"function"==typeof $&&el instanceof $&&(el=el[0]),(rect=el.getBoundingClientRect()).bottom>0&&rect.right>0&&rect.left<(window.innerWidth||document.documentElement.clientWidth)&&rect.top<(window.innerHeight||document.documentElement.clientHeight)},FancyBox=function(content,opts,index){var self=this;self.opts=$.extend(!0,{index:index},defaults,opts||{}),self.id=self.opts.id||++called,self.group=[],self.currIndex=parseInt(self.opts.index,10)||0,self.prevIndex=null,self.prevPos=null,self.currPos=0,self.firstRun=null,self.createGroup(content),self.group.length&&(self.$lastFocus=$(document.activeElement).blur(),self.slides={},self.init(content))};$.extend(FancyBox.prototype,{init:function(){var testWidth,$container,self=this,galleryHasHtml=!1;self.scrollTop=$D.scrollTop(),self.scrollLeft=$D.scrollLeft(),$.fancybox.getInstance()||(testWidth=$("body").width(),$("html").addClass("fancybox-enabled"),$.fancybox.isTouch?($.each(self.group,function(key,item){if("image"!==item.type&&"iframe"!==item.type)return galleryHasHtml=!0,!1}),galleryHasHtml&&$("body").css({position:"fixed",width:testWidth,top:-1*self.scrollTop})):(testWidth=$("body").width()-testWidth)>1&&$('<style id="fancybox-noscroll" type="text/css">').html(".compensate-for-scrollbar, .fancybox-enabled body { margin-right: "+testWidth+"px; }").appendTo("head")),$container=$(self.opts.baseTpl).attr("id","fancybox-container-"+self.id).data("FancyBox",self).addClass(self.opts.baseClass).hide().prependTo(self.opts.parentEl),self.$refs={container:$container,bg:$container.find(".fancybox-bg"),controls:$container.find(".fancybox-controls"),buttons:$container.find(".fancybox-buttons"),slider_wrap:$container.find(".fancybox-slider-wrap"),slider:$container.find(".fancybox-slider"),caption:$container.find(".fancybox-caption")},self.trigger("onInit"),self.activate(),self.current||self.jumpTo(self.currIndex)},createGroup:function(content){var self=this,items=$.makeArray(content);$.each(items,function(i,item){var $item,type,src,srcParts,obj={},opts={},data=[];$.isPlainObject(item)?(obj=item,opts=item.opts||{}):"object"===$.type(item)&&$(item).length?(opts="options"in(data=($item=$(item)).data())?data.options:{},opts="object"===$.type(opts)?opts:{},obj.type="type"in data?data.type:opts.type,obj.src="src"in data?data.src:opts.src||$item.attr("href"),opts.width="width"in data?data.width:opts.width,opts.height="height"in data?data.height:opts.height,opts.thumb="thumb"in data?data.thumb:opts.thumb,opts.selector="selector"in data?data.selector:opts.selector,"srcset"in data&&(opts.image={srcset:data.srcset}),opts.$orig=$item):obj={type:"html",content:item+""},obj.opts=$.extend(!0,{},self.opts,opts),type=obj.type,src=obj.src||"",type||(obj.content?type="html":src.match(/(^data:image\/[a-z0-9+\/=]*,)|(\.(jp(e|g|eg)|gif|png|bmp|webp|svg|ico)((\?|#).*)?$)/i)?type="image":src.match(/\.(pdf)((\?|#).*)?$/i)?type="pdf":"#"===src.charAt(0)&&(type="inline"),obj.type=type),obj.index=self.group.length,obj.opts.$orig&&!obj.opts.$orig.length&&delete obj.opts.$orig,!obj.opts.$thumb&&obj.opts.$orig&&(obj.opts.$thumb=obj.opts.$orig.find("img:first")),obj.opts.$thumb&&!obj.opts.$thumb.length&&delete obj.opts.$thumb,"function"===$.type(obj.opts.caption)?obj.opts.caption=obj.opts.caption.apply(item,[self,obj]):"caption"in data?obj.opts.caption=data.caption:opts.$orig&&(obj.opts.caption=$item.attr("title")),obj.opts.caption=void 0===obj.opts.caption?"":obj.opts.caption+"","ajax"===type&&(srcParts=src.split(/\s+/,2)).length>1&&(obj.src=srcParts.shift(),obj.opts.selector=srcParts.shift()),"auto"==obj.opts.smallBtn&&($.inArray(type,["html","inline","ajax"])>-1?(obj.opts.buttons=!1,obj.opts.smallBtn=!0):obj.opts.smallBtn=!1),"pdf"===type&&(obj.type="iframe",obj.opts.closeBtn=!0,obj.opts.smallBtn=!1,obj.opts.iframe.preload=!1),obj.opts.modal&&$.extend(!0,obj.opts,{infobar:0,buttons:0,keyboard:0,slideShow:0,fullScreen:0,closeClickOutside:0}),self.group.push(obj)})},addEvents:function(){var self=this;self.removeEvents(),self.$refs.container.on("click.fb-close","[data-fancybox-close]",function(e){e.stopPropagation(),e.preventDefault(),self.close(e)}).on("click.fb-previous","[data-fancybox-previous]",function(e){e.stopPropagation(),e.preventDefault(),self.previous()}).on("click.fb-next","[data-fancybox-next]",function(e){e.stopPropagation(),e.preventDefault(),self.next()}),$(window).on("orientationchange.fb resize.fb",function(e){requestAFrame(function(){e&&e.originalEvent&&"resize"===e.originalEvent.type?self.update():(self.$refs.slider_wrap.hide(),requestAFrame(function(){self.$refs.slider_wrap.show(),self.update()}))})}),$D.on("focusin.fb",function(e){var instance=$.fancybox?$.fancybox.getInstance():null;!instance||$(e.target).hasClass("fancybox-container")||$.contains(instance.$refs.container[0],e.target)||(e.stopPropagation(),instance.focus(),$W.scrollTop(self.scrollTop).scrollLeft(self.scrollLeft))}),$D.on("keydown.fb",function(e){var current=self.current,keycode=e.keyCode||e.which;if(current&&current.opts.keyboard&&!$(e.target).is("input")&&!$(e.target).is("textarea")){if(8===keycode||27===keycode)return e.preventDefault(),void self.close(e);switch(keycode){case 37:case 38:e.preventDefault(),self.previous();break;case 39:case 40:e.preventDefault(),self.next();break;case 80:case 32:e.preventDefault(),self.SlideShow&&(e.preventDefault(),self.SlideShow.toggle());break;case 70:self.FullScreen&&(e.preventDefault(),self.FullScreen.toggle());break;case 71:self.Thumbs&&(e.preventDefault(),self.Thumbs.toggle())}}})},removeEvents:function(){$W.off("scroll.fb resize.fb orientationchange.fb"),$D.off("keydown.fb focusin.fb click.fb-close"),this.$refs.container.off("click.fb-close click.fb-previous click.fb-next")},previous:function(duration){this.jumpTo(this.currIndex-1,duration)},next:function(duration){this.jumpTo(this.currIndex+1,duration)},jumpTo:function(to,duration){var firstRun,index,pos,loop,self=this;if(firstRun=self.firstRun=null===self.firstRun,index=pos=to=parseInt(to,10),loop=!!self.current&&self.current.opts.loop,!self.isAnimating&&(index!=self.currIndex||firstRun)){if(self.group.length>1&&loop)index=(index%=self.group.length)<0?self.group.length+index:index,2==self.group.length?pos=to-self.currIndex+self.currPos:(pos=index-self.currIndex+self.currPos,Math.abs(self.currPos-(pos+self.group.length))<Math.abs(self.currPos-pos)?pos+=self.group.length:Math.abs(self.currPos-(pos-self.group.length))<Math.abs(self.currPos-pos)&&(pos-=self.group.length));else if(!self.group[index])return void self.update(!1,!1,duration);self.current&&(self.current.$slide.removeClass("fancybox-slide--current fancybox-slide--complete"),self.updateSlide(self.current,!0)),self.prevIndex=self.currIndex,self.prevPos=self.currPos,self.currIndex=index,self.currPos=pos,self.current=self.createSlide(pos),self.group.length>1&&((self.opts.loop||pos-1>=0)&&self.createSlide(pos-1),(self.opts.loop||pos+1<self.group.length)&&self.createSlide(pos+1)),self.current.isMoved=!1,self.current.isComplete=!1,duration=parseInt(void 0===duration?1.5*self.current.opts.speed:duration,10),self.trigger("beforeMove"),self.updateControls(),firstRun&&(self.current.$slide.addClass("fancybox-slide--current"),self.$refs.container.show(),requestAFrame(function(){self.$refs.bg.css("transition-duration",self.current.opts.speed+"ms"),self.$refs.container.addClass("fancybox-container--ready")})),self.update(!0,!1,firstRun?0:duration,function(){self.afterMove()}),self.loadSlide(self.current),firstRun&&self.current.$ghost||self.preload()}},createSlide:function(pos){var $slide,index,found,self=this;if(index=pos%self.group.length,index=index<0?self.group.length+index:index,!self.slides[pos]&&self.group[index]){if(self.opts.loop&&self.group.length>2)for(var key in self.slides)if(self.slides[key].index===index)return found=self.slides[key],found.pos=pos,self.slides[pos]=found,delete self.slides[key],self.updateSlide(found),found;$slide=$('<div class="fancybox-slide"></div>').appendTo(self.$refs.slider),self.slides[pos]=$.extend(!0,{},self.group[index],{pos:pos,$slide:$slide,isMoved:!1,isLoaded:!1})}return self.slides[pos]},zoomInOut:function(type,duration,callback){var props,start,end,self=this,current=self.current,$what=current.$placeholder,opacity=current.opts.opacity,$thumb=current.opts.$thumb,thumbPos=$thumb?$thumb.offset():0,slidePos=current.$slide.offset();return!!($what&&current.isMoved&&thumbPos&&isElementInViewport($thumb))&&(!("In"===type&&!self.firstRun)&&($.fancybox.stop($what),self.isAnimating=!0,props={top:thumbPos.top-slidePos.top+parseFloat($thumb.css("border-top-width")||0),left:thumbPos.left-slidePos.left+parseFloat($thumb.css("border-left-width")||0),width:$thumb.width(),height:$thumb.height(),scaleX:1,scaleY:1},"auto"==opacity&&(opacity=Math.abs(current.width/current.height-props.width/props.height)>.1),"In"===type?(start=props,(end=self.getFitPos(current)).scaleX=end.width/start.width,end.scaleY=end.height/start.height,opacity&&(start.opacity=.1,end.opacity=1)):(start=$.fancybox.getTranslate($what),end=props,current.$ghost&&(current.$ghost.show(),current.$image&&current.$image.remove()),start.scaleX=start.width/end.width,start.scaleY=start.height/end.height,start.width=end.width,start.height=end.height,opacity&&(end.opacity=0)),self.updateCursor(end.width,end.height),delete end.width,delete end.height,$.fancybox.setTranslate($what,start),$what.show(),self.trigger("beforeZoom"+type),$what.css("transition","all "+duration+"ms"),$.fancybox.setTranslate($what,end),setTimeout(function(){var reset;$what.css("transition","none"),(reset=$.fancybox.getTranslate($what)).scaleX=1,reset.scaleY=1,$.fancybox.setTranslate($what,reset),self.trigger("afterZoom"+type),callback.apply(self),self.isAnimating=!1},duration),!0))},canPan:function(){var self=this,current=self.current,$what=current.$placeholder,rez=!1;return $what&&(rez=self.getFitPos(current),rez=Math.abs($what.width()-rez.width)>1||Math.abs($what.height()-rez.height)>1),rez},isScaledDown:function(){var current=this.current,$what=current.$placeholder,rez=!1;return $what&&(rez=(rez=$.fancybox.getTranslate($what)).width<current.width||rez.height<current.height),rez},scaleToActual:function(x,y,duration){var imgPos,posX,posY,scaleX,scaleY,self=this,current=self.current,$what=current.$placeholder,canvasWidth=parseInt(current.$slide.width(),10),canvasHeight=parseInt(current.$slide.height(),10),newImgWidth=current.width,newImgHeight=current.height;$what&&(self.isAnimating=!0,x=void 0===x?.5*canvasWidth:x,y=void 0===y?.5*canvasHeight:y,scaleX=newImgWidth/(imgPos=$.fancybox.getTranslate($what)).width,scaleY=newImgHeight/imgPos.height,posX=.5*canvasWidth-.5*newImgWidth,posY=.5*canvasHeight-.5*newImgHeight,newImgWidth>canvasWidth&&((posX=imgPos.left*scaleX-(x*scaleX-x))>0&&(posX=0),posX<canvasWidth-newImgWidth&&(posX=canvasWidth-newImgWidth)),newImgHeight>canvasHeight&&((posY=imgPos.top*scaleY-(y*scaleY-y))>0&&(posY=0),posY<canvasHeight-newImgHeight&&(posY=canvasHeight-newImgHeight)),self.updateCursor(newImgWidth,newImgHeight),$.fancybox.animate($what,null,{top:posY,left:posX,scaleX:scaleX,scaleY:scaleY},duration||current.opts.speed,function(){self.isAnimating=!1}))},scaleToFit:function(duration){var end,self=this,current=self.current,$what=current.$placeholder;$what&&(self.isAnimating=!0,end=self.getFitPos(current),self.updateCursor(end.width,end.height),$.fancybox.animate($what,null,{top:end.top,left:end.left,scaleX:end.width/$what.width(),scaleY:end.height/$what.height()},duration||current.opts.speed,function(){self.isAnimating=!1}))},getFitPos:function(slide){var canvasWidth,canvasHeight,minRatio,top,left,width,height,$what=slide.$placeholder||slide.$content,imgWidth=slide.width,imgHeight=slide.height,margin=slide.opts.margin;return!(!$what||!$what.length||!imgWidth&&!imgHeight)&&("number"===$.type(margin)&&(margin=[margin,margin]),2==margin.length&&(margin=[margin[0],margin[1],margin[0],margin[1]]),$W.width()<800&&(margin=[0,0,0,0]),canvasWidth=parseInt(slide.$slide.width(),10)-(margin[1]+margin[3]),canvasHeight=parseInt(slide.$slide.height(),10)-(margin[0]+margin[2]),minRatio=Math.min(1,canvasWidth/imgWidth,canvasHeight/imgHeight),width=Math.floor(minRatio*imgWidth),height=Math.floor(minRatio*imgHeight),top=Math.floor(.5*(canvasHeight-height))+margin[0],left=Math.floor(.5*(canvasWidth-width))+margin[3],{top:top,left:left,width:width,height:height})},update:function(andSlides,andContent,duration,callback){var leftValue,self=this;!0!==self.isAnimating&&self.current&&(leftValue=self.current.pos*Math.floor(self.current.$slide.width())*-1-self.current.pos*self.current.opts.gutter,duration=parseInt(duration,10)||0,$.fancybox.stop(self.$refs.slider),!1===andSlides?self.updateSlide(self.current,andContent):$.each(self.slides,function(key,slide){self.updateSlide(slide,andContent)}),duration?$.fancybox.animate(self.$refs.slider,null,{top:0,left:leftValue},duration,function(){self.current.isMoved=!0,"function"===$.type(callback)&&callback.apply(self)}):($.fancybox.setTranslate(self.$refs.slider,{top:0,left:leftValue}),self.current.isMoved=!0,"function"===$.type(callback)&&callback.apply(self)))},updateSlide:function(slide,andContent){var leftPos,self=this,$what=slide.$placeholder;(slide=slide||self.current)&&!self.isClosing&&((leftPos=slide.pos*Math.floor(slide.$slide.width())+slide.pos*slide.opts.gutter)!==slide.leftPos&&($.fancybox.setTranslate(slide.$slide,{top:0,left:leftPos}),slide.leftPos=leftPos),!1!==andContent&&$what&&($.fancybox.setTranslate($what,self.getFitPos(slide)),slide.pos===self.currPos&&self.updateCursor()),slide.$slide.trigger("refresh"),self.trigger("onUpdate",slide))},updateCursor:function(nextWidth,nextHeight){var self=this,$container=self.$refs.container.removeClass("fancybox-controls--canzoomIn fancybox-controls--canzoomOut fancybox-controls--canGrab");!self.isClosing&&self.opts.touch&&((void 0!==nextWidth&&void 0!==nextHeight?nextWidth<self.current.width&&nextHeight<self.current.height:self.isScaledDown())?$container.addClass("fancybox-controls--canzoomIn"):self.group.length<2?$container.addClass("fancybox-controls--canzoomOut"):$container.addClass("fancybox-controls--canGrab"))},loadSlide:function(slide){var type,$slide,ajaxLoad,self=this;if(slide&&!slide.isLoaded&&!slide.isLoading){switch(slide.isLoading=!0,self.trigger("beforeLoad",slide),type=slide.type,($slide=slide.$slide).off("refresh").trigger("onReset").addClass("fancybox-slide--"+(type||"unknown")).addClass(slide.opts.slideClass),type){case"image":self.setImage(slide);break;case"iframe":self.setIframe(slide);break;case"html":self.setContent(slide,slide.content);break;case"inline":$(slide.src).length?self.setContent(slide,$(slide.src)):self.setError(slide);break;case"ajax":self.showLoading(slide),ajaxLoad=$.ajax($.extend({},slide.opts.ajax.settings,{url:slide.src,success:function(data,textStatus){"success"===textStatus&&self.setContent(slide,data)},error:function(jqXHR,textStatus){jqXHR&&"abort"!==textStatus&&self.setError(slide)}})),$slide.one("onReset",function(){ajaxLoad.abort()});break;default:self.setError(slide)}return!0}},setImage:function(slide){var found,temp,pxRatio,windowWidth,self=this,srcset=slide.opts.image.srcset;if(!slide.isLoaded||slide.hasError){if(srcset){pxRatio=window.devicePixelRatio||1,windowWidth=window.innerWidth*pxRatio,(temp=srcset.split(",").map(function(el){var ret={};return el.trim().split(/\s+/).forEach(function(el,i){var value=parseInt(el.substring(0,el.length-1),10);if(0===i)return ret.url=el;value&&(ret.value=value,ret.postfix=el[el.length-1])}),ret})).sort(function(a,b){return a.value-b.value});for(var j=0;j<temp.length;j++){var el=temp[j];if("w"===el.postfix&&el.value>=windowWidth||"x"===el.postfix&&el.value>=pxRatio){found=el;break}}!found&&temp.length&&(found=temp[temp.length-1]),found&&(slide.src=found.url,slide.width&&slide.height&&"w"==found.postfix&&(slide.height=slide.width/slide.height*found.value,slide.width=found.value))}slide.$placeholder=$('<div class="fancybox-placeholder"></div>').hide().appendTo(slide.$slide),!1!==slide.opts.preload&&slide.opts.width&&slide.opts.height&&(slide.opts.thumb||slide.opts.$thumb)?(slide.width=slide.opts.width,slide.height=slide.opts.height,slide.$ghost=$("<img />").one("load error",function(){self.isClosing||($("<img/>")[0].src=slide.src,self.revealImage(slide,function(){self.setBigImage(slide),self.firstRun&&slide.index===self.currIndex&&self.preload()}))}).addClass("fancybox-image").appendTo(slide.$placeholder).attr("src",slide.opts.thumb||slide.opts.$thumb.attr("src"))):self.setBigImage(slide)}else self.afterLoad(slide)},setBigImage:function(slide){var self=this,$img=$("<img />");slide.$image=$img.one("error",function(){self.setError(slide)}).one("load",function(){clearTimeout(slide.timouts),slide.timouts=null,self.isClosing||(slide.width=this.naturalWidth,slide.height=this.naturalHeight,slide.opts.image.srcset&&$img.attr("sizes","100vw").attr("srcset",slide.opts.image.srcset),self.afterLoad(slide),slide.$ghost&&(slide.timouts=setTimeout(function(){slide.$ghost.hide()},350)))}).addClass("fancybox-image").attr("src",slide.src).appendTo(slide.$placeholder),$img[0].complete?$img.trigger("load"):$img[0].error?$img.trigger("error"):slide.timouts=setTimeout(function(){$img[0].complete||slide.hasError||self.showLoading(slide)},150),slide.opts.image.protect&&$('<div class="fancybox-spaceball"></div>').appendTo(slide.$placeholder).on("contextmenu.fb",function(e){return 2==e.button&&e.preventDefault(),!0})},revealImage:function(slide,callback){var self=this;callback=callback||$.noop,"image"!==slide.type||slide.hasError||!0===slide.isRevealed?callback.apply(self):(slide.isRevealed=!0,slide.pos===self.currPos&&self.zoomInOut("In",slide.opts.speed,callback)||(slide.$ghost&&!slide.isLoaded&&self.updateSlide(slide,!0),slide.pos===self.currPos?$.fancybox.animate(slide.$placeholder,{opacity:0},{opacity:1},300,callback):slide.$placeholder.show(),callback.apply(self)))},setIframe:function(slide){var $iframe,self=this,opts=slide.opts.iframe,$slide=slide.$slide;slide.$content=$('<div class="fancybox-content"></div>').css(opts.css).appendTo($slide),$iframe=$(opts.tpl.replace(/\{rnd\}/g,(new Date).getTime())).attr("scrolling",$.fancybox.isTouch?"auto":opts.scrolling).appendTo(slide.$content),opts.preload?(slide.$content.addClass("fancybox-tmp"),self.showLoading(slide),$iframe.on("load.fb error.fb",function(e){this.isReady=1,slide.$slide.trigger("refresh"),self.afterLoad(slide)}),$slide.on("refresh.fb",function(){var $body,scrollWidth,frameWidth,frameHeight,$wrap=slide.$content;if(1===$iframe[0].isReady){try{$body=$iframe.contents().find("body")}catch(ignore){}$body&&$body.length&&(void 0===opts.css.width||void 0===opts.css.height)&&(scrollWidth=$iframe[0].contentWindow.document.documentElement.scrollWidth,frameWidth=Math.ceil($body.outerWidth(!0)+($wrap.width()-scrollWidth)),frameHeight=Math.ceil($body.outerHeight(!0)),$wrap.css({width:void 0===opts.css.width?frameWidth+($wrap.outerWidth()-$wrap.innerWidth()):opts.css.width,height:void 0===opts.css.height?frameHeight+($wrap.outerHeight()-$wrap.innerHeight()):opts.css.height})),$wrap.removeClass("fancybox-tmp")}})):this.afterLoad(slide),$iframe.attr("src",slide.src),slide.opts.smallBtn&&slide.$content.prepend(slide.opts.closeTpl),$slide.one("onReset",function(){try{$(this).find("iframe").hide().attr("src","//about:blank")}catch(ignore){}$(this).empty(),slide.isLoaded=!1})},setContent:function(slide,content){var self=this;self.isClosing||(self.hideLoading(slide),slide.$slide.empty(),isQuery(content)&&content.parent().length?(content.data("placeholder")&&content.parents(".fancybox-slide").trigger("onReset"),content.data({placeholder:$("<div></div>").hide().insertAfter(content)}).css("display","inline-block")):("string"===$.type(content)&&3===(content=$("<div>").append(content).contents())[0].nodeType&&(content=$("<div>").html(content)),slide.opts.selector&&(content=$("<div>").html(content).find(slide.opts.selector))),slide.$slide.one("onReset",function(){var placeholder=isQuery(content)?content.data("placeholder"):0;placeholder&&(content.hide().replaceAll(placeholder),content.data("placeholder",null)),slide.hasError||($(this).empty(),slide.isLoaded=!1)}),slide.$content=$(content).appendTo(slide.$slide),!0===slide.opts.smallBtn&&slide.$content.find(".fancybox-close-small").remove().end().eq(0).append(slide.opts.closeTpl),this.afterLoad(slide))},setError:function(slide){slide.hasError=!0,this.setContent(slide,slide.opts.errorTpl)},showLoading:function(slide){var self=this;(slide=slide||self.current)&&!slide.$spinner&&(slide.$spinner=$(self.opts.spinnerTpl).appendTo(slide.$slide))},hideLoading:function(slide){var self=this;(slide=slide||self.current)&&slide.$spinner&&(slide.$spinner.remove(),delete slide.$spinner)},afterMove:function(){var self=this,current=self.current,slides={};current&&(current.$slide.siblings().trigger("onReset"),$.each(self.slides,function(key,slide){slide.pos>=self.currPos-1&&slide.pos<=self.currPos+1?slides[slide.pos]=slide:slide&&slide.$slide.remove()}),self.slides=slides,self.trigger("afterMove"),current.isLoaded&&self.complete())},afterLoad:function(slide){var self=this;self.isClosing||(slide.isLoading=!1,slide.isLoaded=!0,self.trigger("afterLoad",slide),self.hideLoading(slide),slide.$ghost||self.updateSlide(slide,!0),slide.index===self.currIndex&&slide.isMoved?self.complete():slide.$ghost||self.revealImage(slide))},complete:function(){var self=this,current=self.current;self.revealImage(current,function(){current.isComplete=!0,current.$slide.addClass("fancybox-slide--complete"),self.updateCursor(),self.trigger("onComplete"),current.opts.focus&&"image"!==current.type&&"iframe"!==current.type&&self.focus()})},preload:function(){var next,prev,self=this;self.group.length<2||(next=self.slides[self.currPos+1],prev=self.slides[self.currPos-1],next&&"image"===next.type&&self.loadSlide(next),prev&&"image"===prev.type&&self.loadSlide(prev))},focus:function(){var $el,current=this.current;($el=current&&current.isComplete?current.$slide.find('button,:input,[tabindex],a:not(".disabled")').filter(":visible:first"):null)&&$el.length||($el=this.$refs.container),$el.focus(),this.$refs.slider_wrap.scrollLeft(0),current&&current.$slide.scrollTop(0)},activate:function(){var self=this;$(".fancybox-container").each(function(){var instance=$(this).data("FancyBox");instance&&instance.uid!==self.uid&&!instance.isClosing&&instance.trigger("onDeactivate")}),self.current&&(self.$refs.container.index()>0&&self.$refs.container.prependTo(document.body),self.updateControls()),self.trigger("onActivate"),self.addEvents()},close:function(e){var self=this,current=self.current,duration=current.opts.speed,done=$.proxy(function(){self.cleanUp(e)},this);return!self.isAnimating&&!self.isClosing&&(!1===self.trigger("beforeClose",e)?($.fancybox.stop(self.$refs.slider),void requestAFrame(function(){self.update(!0,!0,150)})):(self.isClosing=!0,current.timouts&&clearTimeout(current.timouts),!0!==e&&$.fancybox.stop(self.$refs.slider),self.$refs.container.removeClass("fancybox-container--active").addClass("fancybox-container--closing"),current.$slide.removeClass("fancybox-slide--complete").siblings().remove(),current.isMoved||current.$slide.css("overflow","visible"),self.removeEvents(),self.hideLoading(current),self.hideControls(),self.updateCursor(),self.$refs.bg.css("transition-duration",duration+"ms"),this.$refs.container.removeClass("fancybox-container--ready"),void(!0===e?setTimeout(done,duration):self.zoomInOut("Out",duration,done)||$.fancybox.animate(self.$refs.container,null,{opacity:0},duration,"easeInSine",done))))},cleanUp:function(e){var instance,self=this;self.$refs.slider.children().trigger("onReset"),self.$refs.container.empty().remove(),self.trigger("afterClose",e),self.current=null,(instance=$.fancybox.getInstance())?instance.activate():($("html").removeClass("fancybox-enabled"),$("body").removeAttr("style"),$W.scrollTop(self.scrollTop).scrollLeft(self.scrollLeft),$("#fancybox-noscroll").remove()),self.$lastFocus&&self.$lastFocus.focus()},trigger:function(name,slide){var rez,args=Array.prototype.slice.call(arguments,1),self=this,obj=slide&&slide.opts?slide:self.current;if(obj?args.unshift(obj):obj=self,args.unshift(self),$.isFunction(obj.opts[name])&&(rez=obj.opts[name].apply(obj,args)),!1===rez)return rez;"afterClose"===name?$(document).trigger(name+".fb",args):self.$refs.container.trigger(name+".fb",args)},toggleControls:function(force){this.isHiddenControls?this.updateControls(force):this.hideControls()},hideControls:function(){this.isHiddenControls=!0,this.$refs.container.removeClass("fancybox-show-controls"),this.$refs.container.removeClass("fancybox-show-caption")},updateControls:function(force){var self=this,$container=self.$refs.container,$caption=self.$refs.caption,current=self.current,index=current.index,opts=current.opts,caption=opts.caption;this.isHiddenControls&&!0!==force||(this.isHiddenControls=!1,$container.addClass("fancybox-show-controls").toggleClass("fancybox-show-infobar",!!opts.infobar&&self.group.length>1).toggleClass("fancybox-show-buttons",!!opts.buttons).toggleClass("fancybox-is-modal",!!opts.modal),$(".fancybox-button--left",$container).toggleClass("fancybox-button--disabled",!opts.loop&&index<=0),$(".fancybox-button--right",$container).toggleClass("fancybox-button--disabled",!opts.loop&&index>=self.group.length-1),$(".fancybox-button--play",$container).toggle(!!(opts.slideShow&&self.group.length>1)),$(".fancybox-button--close",$container).toggle(!!opts.closeBtn),$(".js-fancybox-count",$container).html(self.group.length),$(".js-fancybox-index",$container).html(index+1),current.$slide.trigger("refresh"),$caption&&$caption.empty(),caption&&caption.length?($caption.html(caption),this.$refs.container.addClass("fancybox-show-caption "),self.$caption=$caption):this.$refs.container.removeClass("fancybox-show-caption"))}}),$.fancybox={version:"3.0.47",defaults:defaults,getInstance:function(command){var instance=$('.fancybox-container:not(".fancybox-container--closing"):first').data("FancyBox"),args=Array.prototype.slice.call(arguments,1);return instance instanceof FancyBox&&("string"===$.type(command)?instance[command].apply(instance,args):"function"===$.type(command)&&command.apply(instance,args),instance)},open:function(items,opts,index){return new FancyBox(items,opts,index)},close:function(all){var instance=this.getInstance();instance&&(instance.close(),!0===all&&this.close())},isTouch:void 0!==document.createTouch&&/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent),use3d:function(){var div=document.createElement("div");return window.getComputedStyle(div).getPropertyValue("transform")&&!(document.documentMode&&document.documentMode<=11)}(),getTranslate:function($el){var position,matrix;return!(!$el||!$el.length)&&(position=$el.get(0).getBoundingClientRect(),matrix=$el.eq(0).css("transform"),matrix=matrix&&-1!==matrix.indexOf("matrix")?(matrix=(matrix=matrix.split("(")[1]).split(")")[0]).split(","):[],matrix=matrix.length?(matrix=matrix.length>10?[matrix[13],matrix[12],matrix[0],matrix[5]]:[matrix[5],matrix[4],matrix[0],matrix[3]]).map(parseFloat):[0,0,1,1],{top:matrix[0],left:matrix[1],scaleX:matrix[2],scaleY:matrix[3],opacity:parseFloat($el.css("opacity")),width:position.width,height:position.height})},setTranslate:function($el,props){var str="",css={};if($el&&props)return void 0===props.left&&void 0===props.top||(str=(void 0===props.left?$el.position().top:props.left)+"px, "+(void 0===props.top?$el.position().top:props.top)+"px",str=this.use3d?"translate3d("+str+", 0px)":"translate("+str+")"),void 0!==props.scaleX&&void 0!==props.scaleY&&(str=(str.length?str+" ":"")+"scale("+props.scaleX+", "+props.scaleY+")"),str.length&&(css.transform=str),void 0!==props.opacity&&(css.opacity=props.opacity),void 0!==props.width&&(css.width=props.width),void 0!==props.height&&(css.height=props.height),$el.css(css)},easing:{easeOutCubic:function(t,b,c,d){return c*((t=t/d-1)*t*t+1)+b},easeInCubic:function(t,b,c,d){return c*(t/=d)*t*t+b},easeOutSine:function(t,b,c,d){return c*Math.sin(t/d*(Math.PI/2))+b},easeInSine:function(t,b,c,d){return-c*Math.cos(t/d*(Math.PI/2))+c+b}},stop:function($el){$el.removeData("animateID")},animate:function($el,from,to,duration,easing,done){var curr,diff,id,self=this,lastTime=null,animTime=0,finish=function(){void 0!==to.scaleX&&void 0!==to.scaleY&&from&&void 0!==from.width&&void 0!==from.height&&(to.width=from.width*to.scaleX,to.height=from.height*to.scaleY,to.scaleX=1,to.scaleY=1),self.setTranslate($el,to),done()},frame=function(timestamp){if(curr=[],diff=0,$el.length&&$el.data("animateID")===id)if(timestamp=timestamp||Date.now(),lastTime&&(diff=timestamp-lastTime),lastTime=timestamp,(animTime+=diff)>=duration)finish();else{for(var prop in to)to.hasOwnProperty(prop)&&void 0!==from[prop]&&(from[prop]==to[prop]?curr[prop]=to[prop]:curr[prop]=self.easing[easing](animTime,from[prop],to[prop]-from[prop],duration));self.setTranslate($el,curr),requestAFrame(frame)}};self.animateID=id=void 0===self.animateID?1:self.animateID+1,$el.data("animateID",id),void 0===done&&"function"==$.type(easing)&&(done=easing,easing=void 0),easing||(easing="easeOutCubic"),done=done||$.noop,from?this.setTranslate($el,from):from=this.getTranslate($el),duration?($el.show(),requestAFrame(frame)):finish()}},$.fn.fancybox=function(options){return this.off("click.fb-start").on("click.fb-start",{items:this,options:options||{}},_run),this},$(document).on("click.fb-start","[data-fancybox]",_run)}}(window,document,window.jQuery),function($){"use strict";var format=function(url,rez,params){if(url)return params=params||"","object"===$.type(params)&&(params=$.param(params,!0)),$.each(rez,function(key,value){url=url.replace("$"+key,value||"")}),params.length&&(url+=(url.indexOf("?")>0?"&":"?")+params),url},media={youtube:{matcher:/(youtube\.com|youtu\.be|youtube\-nocookie\.com)\/(watch\?(.*&)?v=|v\/|u\/|embed\/?)?(videoseries\?list=(.*)|[\w-]{11}|\?listType=(.*)&list=(.*))(.*)/i,params:{autoplay:1,autohide:1,fs:1,rel:0,hd:1,wmode:"transparent",enablejsapi:1,html5:1},paramPlace:8,type:"iframe",url:"//www.youtube.com/embed/$4",thumb:"//img.youtube.com/vi/$4/hqdefault.jpg"},vimeo:{matcher:/^.+vimeo.com\/(.*\/)?([\d]+)(.*)?/,params:{autoplay:1,hd:1,show_title:1,show_byline:1,show_portrait:0,fullscreen:1,api:1},paramPlace:3,type:"iframe",url:"//player.vimeo.com/video/$2"},metacafe:{matcher:/metacafe.com\/watch\/(\d+)\/(.*)?/,type:"iframe",url:"//www.metacafe.com/embed/$1/?ap=1"},dailymotion:{matcher:/dailymotion.com\/video\/(.*)\/?(.*)/,params:{additionalInfos:0,autoStart:1},type:"iframe",url:"//www.dailymotion.com/embed/video/$1"},vine:{matcher:/vine.co\/v\/([a-zA-Z0-9\?\=\-]+)/,type:"iframe",url:"//vine.co/v/$1/embed/simple"},instagram:{matcher:/(instagr\.am|instagram\.com)\/p\/([a-zA-Z0-9_\-]+)\/?/i,type:"image",url:"//$1/p/$2/media/?size=l"},google_maps:{matcher:/(maps\.)?google\.([a-z]{2,3}(\.[a-z]{2})?)\/(((maps\/(place\/(.*)\/)?\@(.*),(\d+.?\d+?)z))|(\?ll=))(.*)?/i,type:"iframe",url:function(rez){return"//maps.google."+rez[2]+"/?ll="+(rez[9]?rez[9]+"&z="+Math.floor(rez[10])+(rez[12]?rez[12].replace(/^\//,"&"):""):rez[12])+"&output="+(rez[12]&&rez[12].indexOf("layer=c")>0?"svembed":"embed")}}};$(document).on("onInit.fb",function(e,instance){$.each(instance.group,function(i,item){var thumb,rez,params,urlParams,o,provider,url=item.src||"",type=!1;item.type||($.each(media,function(n,el){if(rez=url.match(el.matcher),o={},provider=n,rez){if(type=el.type,el.paramPlace&&rez[el.paramPlace]){"?"==(urlParams=rez[el.paramPlace])[0]&&(urlParams=urlParams.substring(1)),urlParams=urlParams.split("&");for(var m=0;m<urlParams.length;++m){var p=urlParams[m].split("=",2);2==p.length&&(o[p[0]]=decodeURIComponent(p[1].replace(/\+/g," ")))}}return params=$.extend(!0,{},el.params,item.opts[n],o),url="function"===$.type(el.url)?el.url.call(this,rez,params,item):format(el.url,rez,params),thumb="function"===$.type(el.thumb)?el.thumb.call(this,rez,params,item):format(el.thumb,rez),"vimeo"===provider&&(url=url.replace("&%23","#")),!1}}),type?(item.src=url,item.type=type,item.opts.thumb||item.opts.$thumb&&item.opts.$thumb.length||(item.opts.thumb=thumb),"iframe"===type&&($.extend(!0,item.opts,{iframe:{preload:!1,scrolling:"no"},smallBtn:!1,closeBtn:!0,fullScreen:!1,slideShow:!1}),item.opts.slideClass+=" fancybox-slide--video")):item.type="iframe")})})}(window.jQuery),function(window,document,$){"use strict";var requestAFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(callback){window.setTimeout(callback,1e3/60)}}(),pointers=function(e){var result=[];e=(e=e.originalEvent||e||window.e).touches&&e.touches.length?e.touches:e.changedTouches&&e.changedTouches.length?e.changedTouches:[e];for(var key in e)e[key].pageX?result.push({x:e[key].pageX,y:e[key].pageY}):e[key].clientX&&result.push({x:e[key].clientX,y:e[key].clientY});return result},distance=function(point2,point1,what){return point1&&point2?"x"===what?point2.x-point1.x:"y"===what?point2.y-point1.y:Math.sqrt(Math.pow(point2.x-point1.x,2)+Math.pow(point2.y-point1.y,2)):0},isClickable=function($el){return $el.is("a")||$el.is("button")||$el.is("input")||$el.is("select")||$el.is("textarea")||$.isFunction($el.get(0).onclick)},hasScrollbars=function(el){var overflowY=window.getComputedStyle(el)["overflow-y"],overflowX=window.getComputedStyle(el)["overflow-x"],vertical=("scroll"===overflowY||"auto"===overflowY)&&el.scrollHeight>el.clientHeight,horizontal=("scroll"===overflowX||"auto"===overflowX)&&el.scrollWidth>el.clientWidth;return vertical||horizontal},isScrollable=function($el){for(var rez=!1;;){if(rez=hasScrollbars($el.get(0)))break;if(!($el=$el.parent()).length||$el.hasClass("fancybox-slider")||$el.is("body"))break}return rez},Guestures=function(instance){var self=this;self.instance=instance,self.$wrap=instance.$refs.slider_wrap,self.$slider=instance.$refs.slider,self.$container=instance.$refs.container,self.destroy(),self.$wrap.on("touchstart.fb mousedown.fb",$.proxy(self,"ontouchstart"))};Guestures.prototype.destroy=function(){this.$wrap.off("touchstart.fb mousedown.fb touchmove.fb mousemove.fb touchend.fb touchcancel.fb mouseup.fb mouseleave.fb")},Guestures.prototype.ontouchstart=function(e){var self=this,$target=$(e.target),current=self.instance.current,$content=current.$content||current.$placeholder;return self.startPoints=pointers(e),self.$target=$target,self.$content=$content,self.canvasWidth=Math.round(current.$slide[0].clientWidth),self.canvasHeight=Math.round(current.$slide[0].clientHeight),self.startEvent=e,e.originalEvent.clientX>self.canvasWidth+current.$slide.offset().left||(isClickable($target)||isClickable($target.parent())||isScrollable($target)?void 0:current.opts.touch?void(e.originalEvent&&2==e.originalEvent.button||(e.stopPropagation(),e.preventDefault(),!current||self.instance.isAnimating||self.instance.isClosing||!self.startPoints||self.startPoints.length>1&&!current.isMoved||(self.$wrap.off("touchmove.fb mousemove.fb",$.proxy(self,"ontouchmove")),self.$wrap.off("touchend.fb touchcancel.fb mouseup.fb mouseleave.fb",$.proxy(self,"ontouchend")),self.$wrap.on("touchend.fb touchcancel.fb mouseup.fb mouseleave.fb",$.proxy(self,"ontouchend")),self.$wrap.on("touchmove.fb mousemove.fb",$.proxy(self,"ontouchmove")),self.startTime=(new Date).getTime(),self.distanceX=self.distanceY=self.distance=0,self.canTap=!1,self.isPanning=!1,self.isSwiping=!1,self.isZooming=!1,self.sliderStartPos=$.fancybox.getTranslate(self.$slider),self.contentStartPos=$.fancybox.getTranslate(self.$content),self.contentLastPos=null,1!==self.startPoints.length||self.isZooming||(self.canTap=current.isMoved,"image"===current.type&&(self.contentStartPos.width>self.canvasWidth+1||self.contentStartPos.height>self.canvasHeight+1)?($.fancybox.stop(self.$content),self.isPanning=!0):($.fancybox.stop(self.$slider),self.isSwiping=!0),self.$container.addClass("fancybox-controls--isGrabbing")),2===self.startPoints.length&&current.isMoved&&!current.hasError&&"image"===current.type&&(current.isLoaded||current.$ghost)&&(self.isZooming=!0,self.isSwiping=!1,self.isPanning=!1,$.fancybox.stop(self.$content),self.centerPointStartX=.5*(self.startPoints[0].x+self.startPoints[1].x)-$(window).scrollLeft(),self.centerPointStartY=.5*(self.startPoints[0].y+self.startPoints[1].y)-$(window).scrollTop(),self.percentageOfImageAtPinchPointX=(self.centerPointStartX-self.contentStartPos.left)/self.contentStartPos.width,self.percentageOfImageAtPinchPointY=(self.centerPointStartY-self.contentStartPos.top)/self.contentStartPos.height,self.startDistanceBetweenFingers=distance(self.startPoints[0],self.startPoints[1]))))):(self.endPoints=self.startPoints,self.ontap()))},Guestures.prototype.ontouchmove=function(e){var self=this;e.preventDefault(),self.newPoints=pointers(e),self.newPoints&&self.newPoints.length&&(self.distanceX=distance(self.newPoints[0],self.startPoints[0],"x"),self.distanceY=distance(self.newPoints[0],self.startPoints[0],"y"),self.distance=distance(self.newPoints[0],self.startPoints[0]),self.distance>0&&(self.isSwiping?self.onSwipe():self.isPanning?self.onPan():self.isZooming&&self.onZoom()))},Guestures.prototype.onSwipe=function(){var angle,self=this,swiping=self.isSwiping,left=self.sliderStartPos.left;!0===swiping?Math.abs(self.distance)>10&&(self.instance.group.length<2?self.isSwiping="y":!self.instance.current.isMoved||!1===self.instance.opts.touch.vertical||"auto"===self.instance.opts.touch.vertical&&$(window).width()>800?self.isSwiping="x":(angle=Math.abs(180*Math.atan2(self.distanceY,self.distanceX)/Math.PI),self.isSwiping=angle>45&&angle<135?"y":"x"),self.canTap=!1,self.instance.current.isMoved=!1,self.startPoints=self.newPoints):("x"==swiping&&(!self.instance.current.opts.loop&&0===self.instance.current.index&&self.distanceX>0?left+=Math.pow(self.distanceX,.8):!self.instance.current.opts.loop&&self.instance.current.index===self.instance.group.length-1&&self.distanceX<0?left-=Math.pow(-self.distanceX,.8):left+=self.distanceX),self.sliderLastPos={top:"x"==swiping?0:self.sliderStartPos.top+self.distanceY,left:left},requestAFrame(function(){$.fancybox.setTranslate(self.$slider,self.sliderLastPos)}))},Guestures.prototype.onPan=function(){var newOffsetX,newOffsetY,newPos,self=this;self.canTap=!1,newOffsetX=self.contentStartPos.width>self.canvasWidth?self.contentStartPos.left+self.distanceX:self.contentStartPos.left,newOffsetY=self.contentStartPos.top+self.distanceY,(newPos=self.limitMovement(newOffsetX,newOffsetY,self.contentStartPos.width,self.contentStartPos.height)).scaleX=self.contentStartPos.scaleX,newPos.scaleY=self.contentStartPos.scaleY,self.contentLastPos=newPos,requestAFrame(function(){$.fancybox.setTranslate(self.$content,self.contentLastPos)})},Guestures.prototype.limitMovement=function(newOffsetX,newOffsetY,newWidth,newHeight){var minTranslateX,minTranslateY,maxTranslateX,maxTranslateY,self=this,canvasWidth=self.canvasWidth,canvasHeight=self.canvasHeight,currentOffsetX=self.contentStartPos.left,currentOffsetY=self.contentStartPos.top,distanceX=self.distanceX,distanceY=self.distanceY;return minTranslateX=Math.max(0,.5*canvasWidth-.5*newWidth),minTranslateY=Math.max(0,.5*canvasHeight-.5*newHeight),maxTranslateX=Math.min(canvasWidth-newWidth,.5*canvasWidth-.5*newWidth),maxTranslateY=Math.min(canvasHeight-newHeight,.5*canvasHeight-.5*newHeight),newWidth>canvasWidth&&(distanceX>0&&newOffsetX>minTranslateX&&(newOffsetX=minTranslateX-1+Math.pow(-minTranslateX+currentOffsetX+distanceX,.8)||0),distanceX<0&&newOffsetX<maxTranslateX&&(newOffsetX=maxTranslateX+1-Math.pow(maxTranslateX-currentOffsetX-distanceX,.8)||0)),newHeight>canvasHeight&&(distanceY>0&&newOffsetY>minTranslateY&&(newOffsetY=minTranslateY-1+Math.pow(-minTranslateY+currentOffsetY+distanceY,.8)||0),distanceY<0&&newOffsetY<maxTranslateY&&(newOffsetY=maxTranslateY+1-Math.pow(maxTranslateY-currentOffsetY-distanceY,.8)||0)),{top:newOffsetY,left:newOffsetX}},Guestures.prototype.limitPosition=function(newOffsetX,newOffsetY,newWidth,newHeight){var self=this,canvasWidth=self.canvasWidth,canvasHeight=self.canvasHeight;return newOffsetX=newWidth>canvasWidth?(newOffsetX=newOffsetX>0?0:newOffsetX)<canvasWidth-newWidth?canvasWidth-newWidth:newOffsetX:Math.max(0,canvasWidth/2-newWidth/2),newOffsetY=newHeight>canvasHeight?(newOffsetY=newOffsetY>0?0:newOffsetY)<canvasHeight-newHeight?canvasHeight-newHeight:newOffsetY:Math.max(0,canvasHeight/2-newHeight/2),{top:newOffsetY,left:newOffsetX}},Guestures.prototype.onZoom=function(){var self=this,currentWidth=self.contentStartPos.width,currentHeight=self.contentStartPos.height,currentOffsetX=self.contentStartPos.left,currentOffsetY=self.contentStartPos.top,pinchRatio=distance(self.newPoints[0],self.newPoints[1])/self.startDistanceBetweenFingers,newWidth=Math.floor(currentWidth*pinchRatio),newHeight=Math.floor(currentHeight*pinchRatio),translateFromZoomingX=(currentWidth-newWidth)*self.percentageOfImageAtPinchPointX,translateFromZoomingY=(currentHeight-newHeight)*self.percentageOfImageAtPinchPointY,centerPointEndX=(self.newPoints[0].x+self.newPoints[1].x)/2-$(window).scrollLeft(),centerPointEndY=(self.newPoints[0].y+self.newPoints[1].y)/2-$(window).scrollTop(),translateFromTranslatingX=centerPointEndX-self.centerPointStartX,newPos={top:currentOffsetY+(translateFromZoomingY+(centerPointEndY-self.centerPointStartY)),left:currentOffsetX+(translateFromZoomingX+translateFromTranslatingX),scaleX:self.contentStartPos.scaleX*pinchRatio,scaleY:self.contentStartPos.scaleY*pinchRatio};self.canTap=!1,self.newWidth=newWidth,self.newHeight=newHeight,self.contentLastPos=newPos,requestAFrame(function(){$.fancybox.setTranslate(self.$content,self.contentLastPos)})},Guestures.prototype.ontouchend=function(e){var self=this,current=self.instance.current,dMs=Math.max((new Date).getTime()-self.startTime,1),swiping=self.isSwiping,panning=self.isPanning,zooming=self.isZooming;if(self.endPoints=pointers(e),self.$container.removeClass("fancybox-controls--isGrabbing"),self.$wrap.off("touchmove.fb mousemove.fb",$.proxy(this,"ontouchmove")),self.$wrap.off("touchend.fb touchcancel.fb mouseup.fb mouseleave.fb",$.proxy(this,"ontouchend")),self.isSwiping=!1,self.isPanning=!1,self.isZooming=!1,self.canTap)return self.ontap();self.velocityX=self.distanceX/dMs*.5,self.velocityY=self.distanceY/dMs*.5,self.speed=current.opts.speed||330,self.speedX=Math.max(.75*self.speed,Math.min(1.5*self.speed,1/Math.abs(self.velocityX)*self.speed)),self.speedY=Math.max(.75*self.speed,Math.min(1.5*self.speed,1/Math.abs(self.velocityY)*self.speed)),panning?self.endPanning():zooming?self.endZooming():self.endSwiping(swiping)},Guestures.prototype.endSwiping=function(swiping){var self=this;"y"==swiping&&Math.abs(self.distanceY)>50?($.fancybox.animate(self.$slider,null,{top:self.sliderStartPos.top+self.distanceY+150*self.velocityY,left:self.sliderStartPos.left,opacity:0},self.speedY),self.instance.close(!0)):"x"==swiping&&self.distanceX>50?self.instance.previous(self.speedX):"x"==swiping&&self.distanceX<-50?self.instance.next(self.speedX):self.instance.update(!1,!0,150)},Guestures.prototype.endPanning=function(){var newOffsetX,newOffsetY,newPos,self=this;self.contentLastPos&&(newOffsetX=self.contentLastPos.left+self.velocityX*self.speed*2,newOffsetY=self.contentLastPos.top+self.velocityY*self.speed*2,(newPos=self.limitPosition(newOffsetX,newOffsetY,self.contentStartPos.width,self.contentStartPos.height)).width=self.contentStartPos.width,newPos.height=self.contentStartPos.height,$.fancybox.animate(self.$content,null,newPos,self.speed,"easeOutSine"))},Guestures.prototype.endZooming=function(){var newOffsetX,newOffsetY,newPos,reset,self=this,current=self.instance.current,newWidth=self.newWidth,newHeight=self.newHeight;self.contentLastPos&&(newOffsetX=self.contentLastPos.left,reset={top:newOffsetY=self.contentLastPos.top,left:newOffsetX,width:newWidth,height:newHeight,scaleX:1,scaleY:1},$.fancybox.setTranslate(self.$content,reset),newWidth<self.canvasWidth&&newHeight<self.canvasHeight?self.instance.scaleToFit(150):newWidth>current.width||newHeight>current.height?self.instance.scaleToActual(self.centerPointStartX,self.centerPointStartY,150):(newPos=self.limitPosition(newOffsetX,newOffsetY,newWidth,newHeight),$.fancybox.animate(self.$content,null,newPos,self.speed,"easeOutSine")))},Guestures.prototype.ontap=function(){var self=this,instance=self.instance,current=instance.current,x=self.endPoints[0].x,y=self.endPoints[0].y;if(x-=self.$wrap.offset().left,y-=self.$wrap.offset().top,instance.SlideShow&&instance.SlideShow.isActive&&instance.SlideShow.stop(),!$.fancybox.isTouch)return current.opts.closeClickOutside&&self.$target.is(".fancybox-slide")?void instance.close(self.startEvent):void("image"==current.type&&current.isMoved&&(instance.canPan()?instance.scaleToFit():instance.isScaledDown()?instance.scaleToActual(x,y):instance.group.length<2&&instance.close(self.startEvent)));if(self.tapped){if(clearTimeout(self.tapped),self.tapped=null,Math.abs(x-self.x)>50||Math.abs(y-self.y)>50||!current.isMoved)return this;"image"==current.type&&(current.isLoaded||current.$ghost)&&(instance.canPan()?instance.scaleToFit():instance.isScaledDown()&&instance.scaleToActual(x,y))}else self.x=x,self.y=y,self.tapped=setTimeout(function(){self.tapped=null,instance.toggleControls(!0)},300);return this},$(document).on("onActivate.fb",function(e,instance){instance&&!instance.Guestures&&(instance.Guestures=new Guestures(instance))}),$(document).on("beforeClose.fb",function(e,instance){instance&&instance.Guestures&&instance.Guestures.destroy()})}(window,document,window.jQuery),function(document,$){"use strict";var SlideShow=function(instance){this.instance=instance,this.init()};$.extend(SlideShow.prototype,{timer:null,isActive:!1,$button:null,speed:3e3,init:function(){var self=this;self.$button=$('<button data-fancybox-play class="fancybox-button fancybox-button--play" title="Slideshow (P)"></button>').appendTo(self.instance.$refs.buttons),self.instance.$refs.container.on("click","[data-fancybox-play]",function(){self.toggle()})},set:function(){var self=this;self.instance&&self.instance.current&&(self.instance.current.opts.loop||self.instance.currIndex<self.instance.group.length-1)?self.timer=setTimeout(function(){self.instance.next()},self.instance.current.opts.slideShow.speed||self.speed):self.stop()},clear:function(){var self=this;clearTimeout(self.timer),self.timer=null},start:function(){var self=this;self.stop(),self.instance&&self.instance.current&&(self.instance.current.opts.loop||self.instance.currIndex<self.instance.group.length-1)&&(self.instance.$refs.container.on({"beforeLoad.fb.player":$.proxy(self,"clear"),"onComplete.fb.player":$.proxy(self,"set")}),self.isActive=!0,self.instance.current.isComplete&&self.set(),self.instance.$refs.container.trigger("onPlayStart"),self.$button.addClass("fancybox-button--pause"))},stop:function(){var self=this;self.clear(),self.instance.$refs.container.trigger("onPlayEnd").off(".player"),self.$button.removeClass("fancybox-button--pause"),self.isActive=!1},toggle:function(){var self=this;self.isActive?self.stop():self.start()}}),$(document).on("onInit.fb",function(e,instance){instance&&instance.group.length>1&&instance.opts.slideShow&&!instance.SlideShow&&(instance.SlideShow=new SlideShow(instance))}),$(document).on("beforeClose.fb onDeactivate.fb",function(e,instance){instance&&instance.SlideShow&&instance.SlideShow.stop()})}(document,window.jQuery),function(document,$){"use strict";var fn=function(){var val,i,j,fnMap=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],ret={};for(i=0;i<fnMap.length;i++)if((val=fnMap[i])&&val[1]in document){for(j=0;j<val.length;j++)ret[fnMap[0][j]]=val[j];return ret}return!1}();if(fn){var FullScreen={request:function(elem){(elem=elem||document.documentElement)[fn.requestFullscreen](elem.ALLOW_KEYBOARD_INPUT)},exit:function(){document[fn.exitFullscreen]()},toggle:function(elem){this.isFullscreen()?this.exit():this.request(elem)},isFullscreen:function(){return Boolean(document[fn.fullscreenElement])},enabled:function(){return Boolean(document[fn.fullscreenEnabled])}};$(document).on({"onInit.fb":function(e,instance){var $container;instance&&instance.opts.fullScreen&&!instance.FullScreen&&($container=instance.$refs.container,instance.$refs.button_fs=$('<button data-fancybox-fullscreen class="fancybox-button fancybox-button--fullscreen" title="Full screen (F)"></button>').appendTo(instance.$refs.buttons),$container.on("click.fb-fullscreen","[data-fancybox-fullscreen]",function(e){e.stopPropagation(),e.preventDefault(),FullScreen.toggle($container[0])}),!0===instance.opts.fullScreen.requestOnStart&&FullScreen.request($container[0]))},"beforeMove.fb":function(e,instance){instance&&instance.$refs.button_fs&&instance.$refs.button_fs.toggle(!!instance.current.opts.fullScreen)},"beforeClose.fb":function(){FullScreen.exit()}}),$(document).on(fn.fullscreenchange,function(){var instance=$.fancybox.getInstance(),$what=instance?instance.current.$placeholder:null;$what&&($what.css("transition","none"),instance.isAnimating=!1,instance.update(!0,!0,0))})}}(document,window.jQuery),function(document,$){"use strict";var FancyThumbs=function(instance){this.instance=instance,this.init()};$.extend(FancyThumbs.prototype,{$button:null,$grid:null,$list:null,isVisible:!1,init:function(){var self=this;self.$button=$('<button data-fancybox-thumbs class="fancybox-button fancybox-button--thumbs" title="Thumbnails (G)"></button>').appendTo(this.instance.$refs.buttons).on("touchend click",function(e){e.stopPropagation(),e.preventDefault(),self.toggle()})},create:function(){var list,src,instance=this.instance;this.$grid=$('<div class="fancybox-thumbs"></div>').appendTo(instance.$refs.container),list="<ul>",$.each(instance.group,function(i,item){(src=item.opts.thumb||(item.opts.$thumb?item.opts.$thumb.attr("src"):null))||"image"!==item.type||(src=item.src),src&&src.length&&(list+='<li data-index="'+i+'"  tabindex="0" class="fancybox-thumbs-loading"><img data-src="'+src+'" /></li>')}),list+="</ul>",this.$list=$(list).appendTo(this.$grid).on("click touchstart","li",function(){instance.jumpTo($(this).data("index"))}),this.$list.find("img").hide().one("load",function(){var width,height,widthRatio,heightRatio,$parent=$(this).parent().removeClass("fancybox-thumbs-loading"),thumbWidth=$parent.outerWidth(),thumbHeight=$parent.outerHeight();width=this.naturalWidth||this.width,heightRatio=(height=this.naturalHeight||this.height)/thumbHeight,(widthRatio=width/thumbWidth)>=1&&heightRatio>=1&&(widthRatio>heightRatio?(width/=heightRatio,height=thumbHeight):(width=thumbWidth,height/=widthRatio)),$(this).css({width:Math.floor(width),height:Math.floor(height),"margin-top":Math.min(0,Math.floor(.3*thumbHeight-.3*height)),"margin-left":Math.min(0,Math.floor(.5*thumbWidth-.5*width))}).show()}).each(function(){this.src=$(this).data("src")})},focus:function(){this.instance.current&&this.$list.children().removeClass("fancybox-thumbs-active").filter('[data-index="'+this.instance.current.index+'"]').addClass("fancybox-thumbs-active").focus()},close:function(){this.$grid.hide()},update:function(){this.instance.$refs.container.toggleClass("fancybox-container--thumbs",this.isVisible),this.isVisible?(this.$grid||this.create(),this.$grid.show(),this.focus()):this.$grid&&this.$grid.hide(),this.instance.update()},hide:function(){this.isVisible=!1,this.update()},show:function(){this.isVisible=!0,this.update()},toggle:function(){this.isVisible?this.hide():this.show()}}),$(document).on("onInit.fb",function(e,instance){var first=instance.group[0],second=instance.group[1];instance.opts.thumbs&&!instance.Thumbs&&instance.group.length>1&&("image"==first.type||first.opts.thumb||first.opts.$thumb)&&("image"==second.type||second.opts.thumb||second.opts.$thumb)&&(instance.Thumbs=new FancyThumbs(instance))}),$(document).on("beforeMove.fb",function(e,instance,item){var self=instance&&instance.Thumbs;self&&(item.modal?(self.$button.hide(),self.hide()):(!0===instance.opts.thumbs.showOnStart&&instance.firstRun&&self.show(),self.$button.show(),self.isVisible&&self.focus()))}),$(document).on("beforeClose.fb",function(e,instance){instance&&instance.Thumbs&&(instance.Thumbs.isVisible&&!1!==instance.opts.thumbs.hideOnClosing&&instance.Thumbs.close(),instance.Thumbs=null)})}(document,window.jQuery),function(document,window,$){"use strict";function parseUrl(){var hash=window.location.hash.substr(1),rez=hash.split("-"),index=rez.length>1&&/^\+?\d+$/.test(rez[rez.length-1])?parseInt(rez.pop(-1),10)||1:1,gallery=rez.join("-");return index<1&&(index=1),{hash:hash,index:index,gallery:gallery}}function triggerFromUrl(url){var $el;""!==url.gallery&&(($el=$("[data-fancybox='"+$.escapeSelector(url.gallery)+"']").eq(url.index-1)).length?$el.trigger("click"):$("#"+$.escapeSelector(url.gallery)).trigger("click"))}function getGallery(instance){var opts;return!!instance&&(opts=instance.current?instance.current.opts:instance.opts,opts.$orig?opts.$orig.data("fancybox"):opts.hash||"")}$.escapeSelector||($.escapeSelector=function(sel){var rcssescape=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g,fcssescape=function(ch,asCodePoint){return asCodePoint?"\0"===ch?"":ch.slice(0,-1)+"\\"+ch.charCodeAt(ch.length-1).toString(16)+" ":"\\"+ch};return(sel+"").replace(rcssescape,fcssescape)});var currentHash=null;$(function(){setTimeout(function(){!1!==$.fancybox.defaults.hash&&($(window).on("hashchange.fb",function(){var url=parseUrl();$.fancybox.getInstance()?currentHash&&currentHash!==url.gallery+"-"+url.index&&(currentHash=null,$.fancybox.close()):""!==url.gallery&&triggerFromUrl(url)}),$(document).on({"onInit.fb":function(e,instance){var url=parseUrl(),gallery=getGallery(instance);gallery&&url.gallery&&gallery==url.gallery&&(instance.currIndex=url.index-1)},"beforeMove.fb":function(e,instance,current){var gallery=getGallery(instance);gallery&&""!==gallery&&(window.location.hash.indexOf(gallery)<0&&(instance.opts.origHash=window.location.hash),currentHash=gallery+(instance.group.length>1?"-"+(current.index+1):""),"pushState"in history?history.pushState("",document.title,window.location.pathname+window.location.search+"#"+currentHash):window.location.hash=currentHash)},"beforeClose.fb":function(e,instance,current){var gallery=getGallery(instance),origHash=instance&&instance.opts.origHash?instance.opts.origHash:"";gallery&&""!==gallery&&("pushState"in history?history.pushState("",document.title,window.location.pathname+window.location.search+origHash):window.location.hash=origHash),currentHash=null}}),triggerFromUrl(parseUrl()))},50)})}(document,window,window.jQuery);