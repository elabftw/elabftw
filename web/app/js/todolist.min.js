/*! elabftw https://www.elabftw.net */

!function(){"use strict";function makeEditableTodoitem(){$(".editable").editable(function(value,settings){return $.post("app/controllers/TodolistController.php",{update:!0,body:value,id:$(this).attr("id")}).done(function(data){data.res?notif(data.msg,"ok"):notif(data.msg,"ko")}),value},{tooltip:"Click to edit",indicator:"Saving...",name:"fileComment",submit:"Save",cancel:"Cancel",style:"display:inline"})}var Todolist={controller:"app/controllers/TodolistController.php",create:function(e){e.preventDefault();var body=$("#todo").val(),currentdate=new Date,datetime=currentdate.getFullYear()+"-"+(currentdate.getMonth()+1)+"-"+currentdate.getDate()+" "+currentdate.getHours()+":"+currentdate.getMinutes()+":"+currentdate.getSeconds();""!==body&&$.post(this.controller,{create:!0,body:body}).done(function(data){data.res?($("#todoItems-list").prepend("<li class='todoItem' id='todoItem_"+data.msg+"'><a href='#' class='destroyTodoItem' data-id='"+data.msg+"'>X</a><span style='font-size:60%;display:block;'>"+datetime+"</span><span id='todoItem_"+data.msg+"' class='editable'>"+body+"</li>"),makeEditableTodoitem(),$("#todo").val("")):notif(data.msg,"ko")})},destroy:function(id){$.post(this.controller,{destroy:!0,id:id}).done(function(data){data.res?($("#todoItem_"+id).css("background","#29AEB9"),$("#todoItem_"+id).toggle("blind")):notif(data.msg,"ko")})},destroyAll:function(){$.post(this.controller,{destroyAll:!0}).done(function(data){data.res?$("#todoItems-list").children().toggle("blind"):notif(data.msg,"ko")})},toggle:function(){"none"===$("#todoList").css("display")?$("#todoList").css("display","inline"):$("#todoList").css("display","none")}};$("#todo-form").submit(function(e){Todolist.create(e)}),$(document).on("click",".todoToggle",function(){Todolist.toggle()}),$(document).on("click",".todoDestroyAll",function(){Todolist.destroyAll()}),$(document).on("click",".destroyTodoItem",function(){Todolist.destroy($(this).data("id"))}),$("#todoItems-list").on("mouseover",".editable",function(){makeEditableTodoitem()}),key($("#todoSc").data("toggle"),function(){Todolist.toggle()}),$("#todoItems-list").sortable({axis:"y",helper:"clone",update:function(event,ui){var ordering=$("#todoItems-list").sortable("toArray");$.post("app/controllers/TodolistController.php",{updateOrdering:!0,ordering:ordering,table:"todolist"}).done(function(data){data.res?notif(data.msg,"ok"):notif(data.msg,"ko")})}})}();